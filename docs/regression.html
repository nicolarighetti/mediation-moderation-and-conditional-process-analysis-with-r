<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Mediation Moderation and Conditional Process Analysis with R - Regression analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="site_libs/htmlwidgets-1.6.1/htmlwidgets.js"></script>
<script src="site_libs/viz-1.8.2/viz.js"></script>
<link href="site_libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet">
<script src="site_libs/grViz-binding-1.0.9/grViz.js"></script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Mediation Moderation and Conditional Process Analysis with R</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./introduction.html">
 <span class="menu-text">Introduction</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./Rintro.html">
 <span class="menu-text">Getting started with R</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./EDA.html">
 <span class="menu-text">Exploratory Data Analysis</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./regression.html" aria-current="page">
 <span class="menu-text">Regression Analysis</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./mediation.html">
 <span class="menu-text">Mediation Analysis</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./moderation.html">
 <span class="menu-text">Moderation Analysis</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./conditional.html">
 <span class="menu-text">Conditional Process Analysis</span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Regression analysis</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">Introduction</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">Getting started with R</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">Exploratory Data Analysis</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">Regression Analysis</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">Mediation Analysis</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">Moderation Analysis</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">Conditional Process Analysis</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#the-simple-and-multiple-regression-model" id="toc-the-simple-and-multiple-regression-model" class="nav-link active" data-scroll-target="#the-simple-and-multiple-regression-model">The simple and multiple regression model</a>
  <ul class="collapse">
  <li><a href="#learning-objectives" id="toc-learning-objectives" class="nav-link" data-scroll-target="#learning-objectives">Learning objectives</a></li>
  </ul></li>
  <li><a href="#what-is-a-model" id="toc-what-is-a-model" class="nav-link" data-scroll-target="#what-is-a-model">What is a model?</a>
  <ul class="collapse">
  <li><a href="#example-the-mean-as-a-simple-data-model" id="toc-example-the-mean-as-a-simple-data-model" class="nav-link" data-scroll-target="#example-the-mean-as-a-simple-data-model">Example: the mean as a simple data model</a></li>
  <li><a href="#the-mean-in-regression-analysis" id="toc-the-mean-in-regression-analysis" class="nav-link" data-scroll-target="#the-mean-in-regression-analysis">The mean in regression analysis</a></li>
  </ul></li>
  <li><a href="#linear-models" id="toc-linear-models" class="nav-link" data-scroll-target="#linear-models">Linear models</a></li>
  <li><a href="#the-equation-form" id="toc-the-equation-form" class="nav-link" data-scroll-target="#the-equation-form">The equation form</a></li>
  <li><a href="#multiple-linear-regression-model" id="toc-multiple-linear-regression-model" class="nav-link" data-scroll-target="#multiple-linear-regression-model">Multiple linear regression model</a></li>
  <li><a href="#elements-of-the-linear-model-equation" id="toc-elements-of-the-linear-model-equation" class="nav-link" data-scroll-target="#elements-of-the-linear-model-equation">Elements of the linear model equation</a>
  <ul class="collapse">
  <li><a href="#the-index-j" id="toc-the-index-j" class="nav-link" data-scroll-target="#the-index-j">The index j</a></li>
  <li><a href="#intercept" id="toc-intercept" class="nav-link" data-scroll-target="#intercept">Intercept</a></li>
  <li><a href="#regression-coefficient" id="toc-regression-coefficient" class="nav-link" data-scroll-target="#regression-coefficient">Regression coefficient</a></li>
  <li><a href="#error" id="toc-error" class="nav-link" data-scroll-target="#error">Error</a></li>
  </ul></li>
  <li><a href="#fit-a-linear-regression-model-with-r" id="toc-fit-a-linear-regression-model-with-r" class="nav-link" data-scroll-target="#fit-a-linear-regression-model-with-r">Fit a linear regression model with R</a>
  <ul class="collapse">
  <li><a href="#example" id="toc-example" class="nav-link" data-scroll-target="#example">Example</a></li>
  <li><a href="#output" id="toc-output" class="nav-link" data-scroll-target="#output">Output</a></li>
  </ul></li>
  <li><a href="#interpretation" id="toc-interpretation" class="nav-link" data-scroll-target="#interpretation">Interpretation</a>
  <ul class="collapse">
  <li><a href="#r-squared-1" id="toc-r-squared-1" class="nav-link" data-scroll-target="#r-squared-1">R-squared</a></li>
  <li><a href="#intercept-1" id="toc-intercept-1" class="nav-link" data-scroll-target="#intercept-1">Intercept</a></li>
  <li><a href="#coefficients-1" id="toc-coefficients-1" class="nav-link" data-scroll-target="#coefficients-1">Coefficients</a></li>
  </ul></li>
  <li><a href="#residuals-and-assumptions" id="toc-residuals-and-assumptions" class="nav-link" data-scroll-target="#residuals-and-assumptions">Residuals and assumptions</a>
  <ul class="collapse">
  <li><a href="#check-the-assumptions" id="toc-check-the-assumptions" class="nav-link" data-scroll-target="#check-the-assumptions">Check the assumptions</a></li>
  </ul></li>
  <li><a href="#reading-resources-excercises" id="toc-reading-resources-excercises" class="nav-link" data-scroll-target="#reading-resources-excercises">Reading, resources, excercises</a>
  <ul class="collapse">
  <li><a href="#readings" id="toc-readings" class="nav-link" data-scroll-target="#readings">Readings</a></li>
  <li><a href="#resources" id="toc-resources" class="nav-link" data-scroll-target="#resources">Resources</a></li>
  <li><a href="#excercises" id="toc-excercises" class="nav-link" data-scroll-target="#excercises">Excercises</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">Regression analysis</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<div class="cell">
<div class="cell-output-display">
<div class="grViz html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-61ba9c5d1bce3dfeae7d" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-61ba9c5d1bce3dfeae7d">{"x":{"diagram":"digraph {\n  graph [layout = dot, rankdir = TB]\n  \n  node [shape = rectangle]     \n  rec0 [label = \"EXPLORATORY DATA ANALYSIS\"]\n  rec1 [label = \"A) Descriptive Statistics]\n  rec2 [label = \"B) Correlation and Prediction\"]\n  rec3 [label = \"REGRESSION ANALYSIS\"]\n  rec4 [label = \"C) Simple and Multiple Linear Regression Model\"]\n  rec5 [label = \"D) Statistical Inference\"]\n\n  # edge definitions with the node IDs\n  rec0 -> rec1 -> rec2 -> rec3 -> rec4 -> rec5;\n  }","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<section id="the-simple-and-multiple-regression-model" class="level1">
<h1>The simple and multiple regression model</h1>
<section id="learning-objectives" class="level2">
<h2 class="anchored" data-anchor-id="learning-objectives">Learning objectives</h2>
<ul>
<li>Understand the concept of statistical model</li>
<li>Understand the concept of linear regression model</li>
<li>Know how to fit a linear regression model with R</li>
<li>Know how to interpret the results of linear regression models</li>
<li>Understand the concept of goodness of fit and know how to evaluate it</li>
<li>Understand the assumptions of the linear regression model and know how to evaluate them</li>
</ul>
</section>
</section>
<section id="what-is-a-model" class="level1">
<h1>What is a model?</h1>
<ul>
<li><p>A <strong>model</strong> is an <em>approximate and simplified representation</em> of a real phenomenon which captures its most distinctive features (i.e., trends, patterns, etc).</p></li>
<li><p>A <strong>mathematical model</strong> is a model built from mathematical stuff, such as numbers, formulas, equations, and so on.</p></li>
<li><p>A <strong>statistical model</strong> is a special kind of mathematical model, informed by data and built to predict phenomena characterized by a <em>certain degree of uncertainty</em>, and/or to test out hypotheses about how the system being modeled actually works.</p></li>
</ul>
<section id="example-the-mean-as-a-simple-data-model" class="level3">
<h3 class="anchored" data-anchor-id="example-the-mean-as-a-simple-data-model">Example: the mean as a simple data model</h3>
<blockquote class="blockquote">
<p>For example, we said the <strong>mean</strong> can be considered as a simple data model. Indeed, it is conceivable as a synthetic, simplified and approximate representation of the distribution of a variable. It is a mathematical model, as it is a number, and a statistical model, as it is informed by data and implies a certain level of uncertainty. Actually, the mean is just a rough representation of a variable. In fact, single values can be more or less in line with the mean. The mean is only the value that represents, <em>on average</em>, the different values of a variable. We can also quantify the uncertainty in this type of simple model thanks to the <strong>standard deviation</strong>. Standard deviation can be intended as an approximate measure of the average distance between the data points and the mean. A low standard deviation indicates that values are clustered close to the mean. In that case, the mean can be an excellent model. A high standard deviation means that the values are generally distant from the mean (in this case, the mean can be a relatively poor model of the variable).</p>
</blockquote>
<p>Example: Take a group of four friends whose monthly income is 1,000 euros, 1,500 euros, 4,000 euros and 7,000 euros respectively. Let’s use the mean to build a simple model of their income. We can see that the mean income is EUR 3,375. It is not a very good approximation of the income of these people, if you want to use it to predict the income of each member of the group. The standard deviation is in fact high (SD = 2,750 euro), meaning that there is therefore a great deal of variability and uncertainty: on average, the members’ income is 2,750 euros far from the mean.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>income <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1000</span>, <span class="dv">1500</span>, <span class="dv">4000</span>, <span class="dv">7000</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(income)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3375</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(income)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2750</code></pre>
</div>
</div>
<p>Now consider a group of four friends having a monthly income of EUR 1,000, EUR 1,500, EUR 1,300 and EUR 900 respectively. Let’s use the mean to build a simple model of their income. We can see that the mean income is EUR 1,175, with a low standard deviation (SD = 275). This group is more homogeneous as far as income is concerned, and the mean is a pretty good model of the income of each member.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>income <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1000</span>, <span class="dv">1500</span>, <span class="dv">1300</span>, <span class="dv">900</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(income)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1175</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(income)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 275.3785</code></pre>
</div>
</div>
</section>
<section id="the-mean-in-regression-analysis" class="level3">
<h3 class="anchored" data-anchor-id="the-mean-in-regression-analysis">The mean in regression analysis</h3>
<p>In linear regression, the mean is particularly important:</p>
<ul>
<li>It is used as a <strong>baseline</strong> against which to compare the utility of the model. Linear regression modeling attempts to identify variables that help explain/predict another variable better than its own average. The model using the mean that is used as a baseline is also called the <strong>null model</strong>.</li>
<li>The linear regression model attempts to predict the mean value of a variable, given one or more other variables.</li>
</ul>
</section>
</section>
<section id="linear-models" class="level1">
<h1>Linear models</h1>
<p>A linear model is a special kind of statistical model based on linear relationships (see the Pearsons’ correlation coefficient) between two or more variables.</p>
<p>It is represented as a <strong>mathematical equation</strong> that links one (in case of a <em>simple linear regression model</em>) or more input variables (in case of a <em>multiple linear regression model</em>) to an output variable Y, by exploiting information contained in the <strong>association</strong> between the <strong>inputs</strong> and the <strong>output</strong>.</p>
<ul>
<li>The input variables are also called <strong>“predictors”, or “independent”, “explanatory”, or “antecedent” variables</strong>.</li>
<li>The output variable is also called <strong>“outcome”, “dependent”, or “consequent” variable</strong>.</li>
</ul>
<p>Linear regression models, in their simplest form, can be used for answering <strong>questions of the “whether” or “if” variety</strong>. These questions ask whether two variables are correlated, causally or otherwise (<em>explanation</em>), or if something is more or less likely to happen in one set of circumstances or conditions than another (<em>prediction</em>).</p>
<ul>
<li><strong>Prediction</strong>: predict values taken by the dependent variable when we only know the values taken on by the independent variable(s) (e.g., predict income based on sex and level of education);</li>
<li><strong>Explanation</strong>: explaining the structure of a phenomenon by testing hypotheses about the relationships between dependent and independent variables (i.e., is there a relationships between two variables? How strong is it?)</li>
</ul>
<p>To do that, regression analysis computes an <strong>equation</strong> such that, given the input variables, the result of the equation yields:</p>
<ul>
<li>An estimate of the dependent variable (<em>prediction</em>).</li>
<li>A measure of the importance and <em>statistical significance</em> of the independent variables (<em>explanation</em>).</li>
</ul>
</section>
<section id="the-equation-form" class="level1">
<h1>The equation form</h1>
<p>The <strong>simple linear regression model</strong> is the simplest form of a linear regression model, in that it contains only a single independent variable (<span class="math inline">\(X\)</span>). The general form of the equation is the following:</p>
<p><span class="math display">\[Y_j = i + bX_j + e_j\]</span></p>
<p>For example, <span class="math inline">\(Y\)</span> could be income, and <span class="math inline">\(X\)</span> could be a variable used to try to explain/predict it, say level of education.</p>
<p>The <strong>multiple linear regression model</strong> is an extension of this simpler model, which includes more than one independent variable. For example, it may be used to predict income based on level of education, sex, and other variables.</p>
<p><span class="math display">\[Y_j = i + b_1X_{1j} + b_2X_{2j} + ... + e_j\]</span></p>
<p>From a data set containing the values of the <span class="math inline">\(Xs\)</span> and <span class="math inline">\(Y\)</span> variables, linear regression modeling finds the weights <span class="math inline">\(b_1\)</span>, <span class="math inline">\(b_2\)</span> (referred to as <strong>regression coefficients</strong>) that, multiplied by the values of the variable, represents the best approximation of the values of <span class="math inline">\(Y\)</span> in the equation. To estimate the coefficients of the model, the most common procedure is referred to as <strong>ordinary least squares (OLS)</strong> criterion.</p>
</section>
<section id="multiple-linear-regression-model" class="level1">
<h1>Multiple linear regression model</h1>
<p>In practice, the single linear regression model is never used. If you are only interested in the relationship between two variables, you can calculate a correlation coefficient.</p>
<p>However, the problem with the correlation coefficient is that the relationships between two variables is always ambiguous, and <strong>alternative explanations abound</strong>. For example, the correlation between income and education can simply reflect a difference in the status of the family of origin. Wealthier families have more resources and connections, send their sons and daughters to a better school and help them find better jobs, resulting in higher incomes.</p>
<p>In general terms, what makes the association between two variables <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> ambiguous, leading to alternative explanations, is that <strong>people who differ on X and Y also likely differ on many other things, and it may be those things that are responsible for the association</strong>.</p>
<p>Multiple regression gives a researcher a means of engaging in a kind of mathematically aided counterfactual reasoning by <strong>estimating what the association between each independent variable X and the dependent variable Y would be if people did not differ on the other independent variables</strong> in the regression model. It does this by <em>“mathematically equating”</em> people (or whatever the unit of analysis is) on those variables. This equating process is also refferred to as <strong>partialing out</strong> those other variables from the association between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>, or <strong>statistically control</strong> of those variables.</p>
<blockquote class="blockquote">
<p>Partial out: “to give (a variable) a fixed value while considering the relationship between two related variables” (Merriam-Webster)</p>
</blockquote>
<p>For example, to estimate the effect of level of education on income, we could fit a multiple linear regression model. This model would include variables that we think are associated with income. For example, level of education, wealth of the family of origin, and a measure of social connection. This model can estimate the effect of education on income, <strong>holding constant all other independent variables</strong> (i.e., net of the effect of other variables). In practical terms, this means that the regression model shows an estimate of the effect of education on income among individuals with families of the same status and with the same type of social connections, so this variables should no longer have a confounding effect on our estimate of the effect of education.</p>
</section>
<section id="elements-of-the-linear-model-equation" class="level1">
<h1>Elements of the linear model equation</h1>
<p>To present the main elements of a linear regression model, let’s consider its simplest form:</p>
<p><span class="math display">\[Y_j = i + bX_j + e_j\]</span></p>
<section id="the-index-j" class="level3">
<h3 class="anchored" data-anchor-id="the-index-j">The index j</h3>
<p><span class="math inline">\(_j\)</span> is any unique observation/case within the dataset. Since rows represent cases, you can view the subscript <span class="math inline">\(_j\)</span> as a row in a dataset.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">Y =</span> <span class="fu">c</span>(<span class="dv">12</span>, <span class="dv">23</span>, <span class="dv">34</span>, <span class="dv">54</span>, <span class="dv">45</span>), </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">X =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">35</span>, <span class="dv">45</span>, <span class="dv">57</span>, <span class="dv">87</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  j  Y  X
1 1 12 10
2 2 23 35
3 3 34 45
4 4 54 57
5 5 45 87</code></pre>
</div>
</div>
<p>The index may also be omitted and the regression equation represented as <span class="math inline">\(Y = i + bX + e\)</span>, but it makes it explicit that, for each case, the equation establishes a relationships between the values of the variable <span class="math inline">\(Y\)</span> (the dependent or outcome variable) and <span class="math inline">\(X\)</span> (the independent or antecedent variable).</p>
</section>
<section id="intercept" class="level3">
<h3 class="anchored" data-anchor-id="intercept">Intercept</h3>
<p><span class="math display">\[Y_j = i + bX_j + e_j\]</span></p>
<p><span class="math inline">\(i\)</span> is a numerical coefficient estimated by the regression model. It is a constant (i.e., a fixed value) and is referred to as <strong>intercept</strong> or <strong>constant</strong>. It is the average (mean) value of <span class="math inline">\(Y\)</span> when the independent variable(s) assume the value 0.</p>
<p>Although the intercept is mathematically significant, <strong>it often makes no sense and cannot be interpreted</strong>. It is not meaningful when:</p>
<ul>
<li>the independent variables do not include zero in their data range</li>
<li>this value is not significant or even impossible</li>
</ul>
<p>For example, if we predict the weight of people based on height, the intercept has no substantial meaning, because there is no person with a height equal to zero. In case like this, the intercept can be ignored.</p>
</section>
<section id="regression-coefficient" class="level3">
<h3 class="anchored" data-anchor-id="regression-coefficient">Regression coefficient</h3>
<p><span class="math display">\[Y_j = i + bX_j + e_j\]</span></p>
<p><span class="math inline">\(b\)</span> (or <strong>beta</strong>) is a numerical coefficient estimated by the regression model (e.g., through the OLS procedure). It is referred to as <strong>regression coefficient</strong> and represents the <em>weight</em> assigned to the values of the variable <span class="math inline">\(X\)</span>. It represents the <strong>average change in</strong> <span class="math inline">\(Y\)</span> for every one unit increase in <span class="math inline">\(X\)</span>. When using a <strong>multiple linear regression model</strong> (<span class="math inline">\(Y_j = i + b_1X_{1j} + b_2X_{2j} + ... + e_j\)</span>). It represents the <strong>average change in</strong> <span class="math inline">\(Y\)</span> for every one unit increase in <span class="math inline">\(X\)</span>, holding all other independent variables constant.</p>
</section>
<section id="error" class="level3">
<h3 class="anchored" data-anchor-id="error">Error</h3>
<p><span class="math inline">\(e\)</span> is the <em>error</em> or <strong>residual</strong>, and represents the imprecision and uncertainty in the estimate. It is the <strong>difference between the values of Y estimated by the model, and the true Y values</strong>.</p>
</section>
</section>
<section id="fit-a-linear-regression-model-with-r" class="level1">
<h1>Fit a linear regression model with R</h1>
<p>The R function to fit a linear regression model is <strong>lm()</strong>.</p>
<p>The function takes at least two arguments separated by a <em>tilde</em> (~ check how to write that with your specific keyword. You can also copy it from the help by typing ?tilde):</p>
<ul>
<li>To the left of the tilde is the dependant variable (<span class="math inline">\(Y\)</span>)</li>
<li>To the right of the tilde is the independent variables (<span class="math inline">\(X\)</span>) separated with the plus (+) symbol.</li>
</ul>
<p>We also use the argument <em>data</em> for the name of the dataset.</p>
<p>The function <strong>summary</strong> is used to see the results of the model fitting functions.</p>
<section id="example" class="level3">
<h3 class="anchored" data-anchor-id="example">Example</h3>
<p>Load the dataset “glbwarm”.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load the dataset</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>glbwarm <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"data/glbwarm.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="simple-linear-regression" class="level4">
<h4 class="anchored" data-anchor-id="simple-linear-regression">Simple linear regression</h4>
<p>Let’s fit a <strong>simple linear regression model</strong> that predicts support for government action to mitigate climate change (independent variable <span class="math inline">\(Y = govact\)</span>), based on negative emotion about this issue (<span class="math inline">\(X = negemot\)</span>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>lm1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(govact <span class="sc">~</span> negemot, <span class="at">data =</span> glbwarm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The function <strong>summary</strong> produce the output.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = govact ~ negemot, data = glbwarm)

Residuals:
    Min      1Q  Median      3Q     Max 
-4.3285 -0.6731  0.1018  0.7554  3.2142 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  2.75732    0.09866   27.95   &lt;2e-16 ***
negemot      0.51424    0.02548   20.18   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.111 on 813 degrees of freedom
Multiple R-squared:  0.3338,    Adjusted R-squared:  0.333 
F-statistic: 407.3 on 1 and 813 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
</section>
<section id="multiple-linear-regression" class="level4">
<h4 class="anchored" data-anchor-id="multiple-linear-regression">Multiple linear regression</h4>
<p>The following code fits a <strong>multiple linear regression model</strong> that predicts support for government action to mitigate climate change (independent variable <span class="math inline">\(Y = govact\)</span>), based on several variables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>lm2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(govact <span class="sc">~</span> negemot <span class="sc">+</span> posemot <span class="sc">+</span> ideology <span class="sc">+</span> sex <span class="sc">+</span> age, </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">data =</span> glbwarm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = govact ~ negemot + posemot + ideology + sex + age, 
    data = glbwarm)

Residuals:
    Min      1Q  Median      3Q     Max 
-4.8381 -0.6834  0.0705  0.7008  3.4266 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  4.063607   0.205323  19.791  &lt; 2e-16 ***
negemot      0.440781   0.026433  16.676  &lt; 2e-16 ***
posemot     -0.026778   0.028145  -0.951    0.342    
ideology    -0.218269   0.027043  -8.071 2.51e-15 ***
sex         -0.010066   0.076743  -0.131    0.896    
age         -0.001309   0.002371  -0.552    0.581    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.067 on 809 degrees of freedom
Multiple R-squared:  0.3883,    Adjusted R-squared:  0.3845 
F-statistic: 102.7 on 5 and 809 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
</section>
</section>
<section id="output" class="level3">
<h3 class="anchored" data-anchor-id="output">Output</h3>
<p>Consider the output of the “lm2” multiple linear regression model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = govact ~ negemot + posemot + ideology + sex + age, 
    data = glbwarm)

Residuals:
    Min      1Q  Median      3Q     Max 
-4.8381 -0.6834  0.0705  0.7008  3.4266 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  4.063607   0.205323  19.791  &lt; 2e-16 ***
negemot      0.440781   0.026433  16.676  &lt; 2e-16 ***
posemot     -0.026778   0.028145  -0.951    0.342    
ideology    -0.218269   0.027043  -8.071 2.51e-15 ***
sex         -0.010066   0.076743  -0.131    0.896    
age         -0.001309   0.002371  -0.552    0.581    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.067 on 809 degrees of freedom
Multiple R-squared:  0.3883,    Adjusted R-squared:  0.3845 
F-statistic: 102.7 on 5 and 809 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>The output is composed of the following sections:</p>
<section id="residuals" class="level4">
<h4 class="anchored" data-anchor-id="residuals">Residuals</h4>
<p>At the top of the output, there is the five-number summary of <strong>Residuals</strong> (the errors). In linear regression, the distribution is expected to have some characteristics. These will be discussed later when presenting the linear regression assumptions.</p>
</section>
<section id="r-squared" class="level4">
<h4 class="anchored" data-anchor-id="r-squared">R-squared</h4>
<p>At the bottom of the table, there is general information on the model. Of particual interest is the <strong>R-squared</strong> and the <strong>p-value</strong>:</p>
<ul>
<li>After fitting a linear regression model, you need to determine how well the model fits the data. Does it do a good job of explaining changes in the dependent variable? The <strong>R-squared is a goodness-of-fit measure</strong> which indicates on a scale from 0 to 1 the extent to which the model can explains/predicts the dependent variable. In more technical terms, is the <strong>proportion of variance (of the dependent variable) explained by the model</strong> (i.e., how well can we predict the value of Y based on the values of Xs?). <strong>Adjusted R-squared</strong> add a penality based on the complexity of the model (number of variables) and can be preferred when fitting multiple linear regression models. Both the Multiple R-squared and the Adjusted R-squared values can be reported. It can be reported as a percentage, for example, in this case, the model explains about 38% of the variance.</li>
<li>The last row of the output reports a <strong>p-value</strong> and the results from the <em>F-statistic</em>. We said that linear regression modeling attempts to identify variables that help explain/predict another variable better than its own average (mean). The <em>F-statistic</em> compares the fitted linear model with a model that only uses the mean of the dependent variable. If the p-value is below 0.05, the fitted model is significantly better that a model using only the mean.</li>
</ul>
<blockquote class="blockquote">
<p>The p-value is expressed in scientific notation (2.2e-16). To convert to a common number, use the function <strong>format</strong>, adding the number you want to convert, and the option <strong>scientific=FALSE</strong>. For example:</p>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">format</span>(<span class="fl">2.2e-16</span>, <span class="at">scientific=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "0.00000000000000022"</code></pre>
</div>
</div>
</section>
<section id="coefficients" class="level4">
<h4 class="anchored" data-anchor-id="coefficients">Coefficients</h4>
<p>In the middle of the output, there is the <strong>Coefficients</strong> table:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = govact ~ negemot + posemot + ideology + sex + age, 
    data = glbwarm)

Residuals:
    Min      1Q  Median      3Q     Max 
-4.8381 -0.6834  0.0705  0.7008  3.4266 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  4.063607   0.205323  19.791  &lt; 2e-16 ***
negemot      0.440781   0.026433  16.676  &lt; 2e-16 ***
posemot     -0.026778   0.028145  -0.951    0.342    
ideology    -0.218269   0.027043  -8.071 2.51e-15 ***
sex         -0.010066   0.076743  -0.131    0.896    
age         -0.001309   0.002371  -0.552    0.581    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.067 on 809 degrees of freedom
Multiple R-squared:  0.3883,    Adjusted R-squared:  0.3845 
F-statistic: 102.7 on 5 and 809 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<ul>
<li><strong>Estimate</strong> reports the <strong>regression coefficients</strong> of the model (i.e., the <span class="math inline">\(b\)</span> (beta) “weight” of independent variables).</li>
<li><strong>Std. Error</strong> is the standard error of the coefficients (estimates), i.e., their standard deviations. We know that standard deviations is a measure of spread, and a measure of the precision with which the regression coefficient is measured.</li>
<li><strong>t value</strong> is the “t statistic” and is the coefficient divided by its standard error. It’s used to calculate the <strong>“Pr (&gt;|t|)”</strong> which is a way to say <strong>p-value</strong>, and is the number that you really need to look at. A p-value below 0.05 is marked with <strong>at least an asterisk</strong> and is said to be <strong>statistically significant</strong>. It indicates that the independent variable has a statistically significant impact on the dependent variable. In other words, we can conclude that <strong>there is a true association between the variables</strong>, since it would be unlikely to observe similar values if such an association did not exist.</li>
</ul>
<blockquote class="blockquote">
<p>Notice that analysis is carried out on a <strong>“sample”</strong> in order to draw conclusions on a <strong>“population”</strong>. A sample is a subset of cases (e.g.&nbsp;the 815 Americans in the GLBWARM dataset) collected from a larger population (e.g.&nbsp;the entire American population). The sample represents the population on a small scale. A “statistically significant” relationship indicates that the observed relationship is a true relationship and not an artifact in the data sample we analysed. It suggests that the relationship exists both in the observed data (a sample) and in the population from which the data originate.</p>
</blockquote>
</section>
</section>
</section>
<section id="interpretation" class="level1">
<h1>Interpretation</h1>
<p>Consider the output of the “lm2” multiple linear regression model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = govact ~ negemot + posemot + ideology + sex + age, 
    data = glbwarm)

Residuals:
    Min      1Q  Median      3Q     Max 
-4.8381 -0.6834  0.0705  0.7008  3.4266 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  4.063607   0.205323  19.791  &lt; 2e-16 ***
negemot      0.440781   0.026433  16.676  &lt; 2e-16 ***
posemot     -0.026778   0.028145  -0.951    0.342    
ideology    -0.218269   0.027043  -8.071 2.51e-15 ***
sex         -0.010066   0.076743  -0.131    0.896    
age         -0.001309   0.002371  -0.552    0.581    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.067 on 809 degrees of freedom
Multiple R-squared:  0.3883,    Adjusted R-squared:  0.3845 
F-statistic: 102.7 on 5 and 809 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>How can we interpret this output?</p>
<section id="r-squared-1" class="level3">
<h3 class="anchored" data-anchor-id="r-squared-1">R-squared</h3>
<p>First, consider the <strong>R-squared</strong>: the model explains a statistically significant (p &lt; .001) and substantial proportion of variance (Multiple R-squared: 0.3883, Adjusted R-squared: 0.3845).</p>
<p>Then turn your attention to the estimates.</p>
</section>
<section id="intercept-1" class="level3">
<h3 class="anchored" data-anchor-id="intercept-1">Intercept</h3>
<ul>
<li>The <strong>intercept is the mean value of Y when all the independent variables are set to zero</strong>. Is that meaningful? You need to consider the distribution of your variables (e.g., using the five-number summary). For example, zero does not even exist in the distribution of <em>negemot</em> and <em>ideology</em>. Therefore, the intercept is not meaningful.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(glbwarm<span class="sc">$</span>negemot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  1.000   2.330   3.670   3.558   5.000   6.000 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(glbwarm<span class="sc">$</span>ideology)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  1.000   3.000   4.000   4.083   5.000   7.000 </code></pre>
</div>
</div>
</section>
<section id="coefficients-1" class="level3">
<h3 class="anchored" data-anchor-id="coefficients-1">Coefficients</h3>
<section id="statistical-significance" class="level4">
<h4 class="anchored" data-anchor-id="statistical-significance">Statistical significance</h4>
<ul>
<li>Take into consideration the <strong>statistical significance</strong> of the variables. Only two variables are statistically significant: <em>negemot and ideology</em>. They are significant at <em>p &lt; 0.001</em> (three asterisks). This means that there is a 1 in 1000 chance of observing such values in a sample, if there was no real relationship between the variables in the population.</li>
<li>The other variables are not statistically significant. This means that we cannot conclude that these independent variables are related to the dependent variable.</li>
</ul>
</section>
<section id="interpretation-of-coefficients" class="level4">
<h4 class="anchored" data-anchor-id="interpretation-of-coefficients">Interpretation of coefficients</h4>
<p>The coefficients of a multiple regression model are <strong>measures of partial association</strong> that quantify the component of the association between an independent and a dependent variable that is unique to that independent variable, relative to other independent variables in the model.</p>
<p>We can use this formulation:</p>
<ul>
<li><strong>Holding all other variables constant</strong> (or, “all other variables being equal”, or a similar formulation), <strong>two cases that differ by one unit</strong> on the negative emotion scale, are estimated to differ by 0.44 unit on average in their support for government action to mitigate climate change. Or also: a <strong>one-unit increase</strong> on the negative emotion scale (negemot) would result in a 0.44 increase in support for government action to mitigate climate change.</li>
<li>Holding all other variables constant, <strong>two cases that differ by one unit</strong> on the ideology scale, are estimated to differ by -0.22 unit in their support for government action to mitigate climate change, with cases one unit higher on that scale (i.e., republicans) estimated to be -0.22 unit lower in their support for government action. Or also, a one-unit increase in the ideology variable would result in a 0.22 <em>decrease</em> (notice the negative sign: -0.218269) in support for government action to mitigate climate change.</li>
</ul>
</section>
<section id="interpreting-dichotomous-variables" class="level4">
<h4 class="anchored" data-anchor-id="interpreting-dichotomous-variables">Interpreting dichotomous variables</h4>
<p>Dichotomous variables take just two values, usually represented by 0 and 1. Within the glbwarm dataset, the variable <em>sex</em> is a dichotomous variable. Females are encoded as 0 and males as 1. In the dichotomy case, a change of 1 unit corresponds to the switching of 0 to 1. That is to say, from the category 0 (e.g., females) to category 1 (e.g., males).</p>
<p>The coefficients estimate the difference in the mean of the dependent variable between two cases that differ by one unit in the independent variable, all other variables being constant. In the dichotomous case, this difference is <span class="math inline">\(1 - 0\)</span>, that is to say, the difference between males and females.</p>
<p>Therefore, the coefficient for sex (-0.010066) indicates that males are estimated to be, on average, 0.01 units <em>less</em> (notice the negative sign) supportive of government action than females.</p>
<p>But we said that the difference is not statistically significant. Therefore, we can conclude that there is no evidence of systematic gender differences in support for government action.</p>
</section>
</section>
</section>
<section id="residuals-and-assumptions" class="level1">
<h1>Residuals and assumptions</h1>
<p>The intepretation of residulas requires to discuss the assumptions of linear models.</p>
<p>Linear regression is founded on some assumptions. The <strong>violation of these assumptions</strong> can have <strong>adverse effects on the interpretation</strong> of the model and on inference, therefore we should be mindful of the assumptions the regression model makes. The main assumptions of the linear regression model are the following:</p>
<ul>
<li><strong>Linearity</strong>: Linearity states that <strong>the relationships between the variables in the model are linear</strong> in nature, or at least approximately linear. For obvious reasons, it’s wrong to use a linear model to understand non-linear relations. Linearity is violated, for instance, when for low values of <span class="math inline">\(X\)</span>, a <em>one</em> unit increase in <span class="math inline">\(X\)</span> corresponds to an increase of <em>one</em> unit in <span class="math inline">\(Y\)</span>, but for high values of <span class="math inline">\(X\)</span>, <em>one</em> unit increase in <span class="math inline">\(X\)</span> corresponds to an increase of <em>three</em> units in <span class="math inline">\(Y\)</span>.</li>
<li><strong>Normality</strong>: The assumption of normality states that <strong>the errors (i.e.&nbsp;residuals) are normally distributed</strong>. In general, <em>linear regression is considered to be “robust” to mild violation of normality</em>. Research suggests that only the most severe violations of the normality assumption substantially affect the validity of statistical inferences from a regression analysis unless the sample size is quite small.</li>
<li><strong>Homoscedasticity</strong>: Homoscedasticity (or homoskedasticity) states that <strong>errors in estimation are almost equal across the range of the estimated values of the outcome</strong> <span class="math inline">\(\hat Y\)</span>. When this condition is not met, the errors in estimation are said to be <em>heteroscedastic</em>.</li>
<li><strong>Independence</strong>: the errors in estimation should be statistically independent. In the most basic terms, two things are independent if <strong>information about one gives no information about the other</strong>. A typical violation of independence is the autocorrelation in <em>time series data</em>, which has to be handled with specific time series techniques.</li>
<li><strong>Outliers</strong>: Observations particularly different from the average are called <strong>outliers</strong>. They may have excessive influence over the coefficient estimates (<em>“influential observations”</em>). If so, they must be thoroughly inspected.</li>
<li><strong>No multicollinearity</strong>: Multicollinearity is the occurrence of high intercorrelations among two or more independent variables in a multiple regression model. It makes it difficult to distinguish the effect of the variables.</li>
</ul>
<section id="check-the-assumptions" class="level3">
<h3 class="anchored" data-anchor-id="check-the-assumptions">Check the assumptions</h3>
<p>In R there are four “diagnostic” plots you can use to assess the assumptions of the model.</p>
<p>You can visualize the plots by using the funtion <strong>plot</strong> applied to the “object” corresponding to your <strong>fitted model</strong>. You can visualize the plots together by using <strong>par(mfrow=c(2,2))</strong> before calling the <em>plot</em> function. In this way, you create a 2x2 layer to show the 4 main diagnostic plots on the same page. You can also visualize a single plot by using the number of the plot inside the <em>plot</em> function (e.g.: <strong>plot(lm_object, 1))</strong>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lm2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="regression_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>In general, you want the <strong>Normal Q-Q plot</strong> to show points along a diagonal line, and the other three plots showing randomly scattered points, without any evident systematic pattern.</p>
<p>Points showing a conic shape in the <strong>Residuals vs Fitted</strong> and <strong>Scale-Location</strong> plots are indicative of an heteroskedasticity problem (violation of the homoscedasticity assumption). Ideally, you should see a <em>roughly horizontal line</em> with <em>equally spread</em> points. A statistical test for checking homoscedasticity is the <strong>Breusch-Pagan test</strong>. It is included in the <strong>lmtest</strong> library. A p-value &lt; 0.05 suggests heteroskedasticity.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.package</span>(<span class="st">"lmtest"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmtest)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: zoo</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'zoo'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    as.Date, as.Date.numeric</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(lm2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    studentized Breusch-Pagan test

data:  lm2
BP = 14.787, df = 5, p-value = 0.01131</code></pre>
</div>
</div>
<p>Heteroskedasticity does not impact coefficients, but affects statistical tests (e.g., tests that conclude whether the coefficients are statistically significant). <strong>There are different ways to mitigate or resolve this and other assumption issues</strong>. A way is to correct the regression model with Heteroscedasticity-Consistent Standard Errors. In R you need the <em>lmtest</em> and <em>sandwich</em> package.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.package</span>(<span class="st">"sandwich"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmtest)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sandwich)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(lm2, <span class="at">vcov =</span> <span class="fu">vcovHC</span>(lm2, <span class="at">type =</span> <span class="st">"HC3"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
t test of coefficients:

              Estimate Std. Error t value  Pr(&gt;|t|)    
(Intercept)  4.0636065  0.1965257 20.6772 &lt; 2.2e-16 ***
negemot      0.4407807  0.0282082 15.6260 &lt; 2.2e-16 ***
posemot     -0.0267777  0.0317203 -0.8442    0.3988    
ideology    -0.2182689  0.0289974 -7.5272 1.384e-13 ***
sex         -0.0100662  0.0753805 -0.1335    0.8938    
age         -0.0013087  0.0022916 -0.5711    0.5681    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>You can also see that certain dots are marked by a number. These are points with unexpectedly high residuals (error) and you could inspect them to find out why (e.g., to exclude there are errors in the dataset). Also check if any point in the <strong>Residuals vs Leverage</strong> plot falls outside of Cook’s distance (a red dashed lines). These points are considered to be influential observations. Influential points have a large influence on the model and should be carefully inspected. In this case there are no influential points, and the red dashed line is not even displayed.</p>
<p>To verify <strong>multicollinearity</strong> you can also calculate the <strong>VIF</strong> (“Variance Inflation Factor”). The function to calculate it is <em>vif</em>, and is included in the package <em>car</em>. The smallest possible value of VIF is one (absence of multicollinearity), and as a rule of thumb, a VIF value that exceeds 5 or 10 indicates a problematic amount of collinearity.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install the package</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"car"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: carData</code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">vif</span>(lm2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> negemot  posemot ideology      sex      age 
1.166374 1.026410 1.194399 1.052894 1.071034 </code></pre>
</div>
</div>
</section>
</section>
<section id="reading-resources-excercises" class="level1">
<h1>Reading, resources, excercises</h1>
<section id="readings" class="level3">
<h3 class="anchored" data-anchor-id="readings">Readings</h3>
<ul>
<li><strong>Chapter 2 - Regression fundermentals</strong> (Moodle)</li>
</ul>
</section>
<section id="resources" class="level3">
<h3 class="anchored" data-anchor-id="resources">Resources</h3>
<p>There are plenty of resources online about linear regression and R. For example:</p>
<ul>
<li><a href="http://www.sthda.com/english/articles/39-regression-model-diagnostics/161-linear-regression-assumptions-and-diagnostics-in-r-essentials/">This website</a> provides a clear explanation of regression diagnostic plots</li>
<li>Also <a href="https://www.youtube.com/watch?v=eTZ4VUZHzxw&amp;list=PLqzoL9-eJTNACQzVDW7ZhoKrveh4-mXv7&amp;index=3">this youtube video</a> provides a simple explanation of regression diagnostic plots.</li>
</ul>
</section>
<section id="excercises" class="level3">
<h3 class="anchored" data-anchor-id="excercises">Excercises</h3>
<p>Use the <strong>estress</strong> dataset (estress.csv) to perform a multiple linear regression model.</p>
<section id="description-of-the-dataset" class="level4">
<h4 class="anchored" data-anchor-id="description-of-the-dataset">Description of the dataset</h4>
<p>The participants in the “estress” study (162 male, 100 female, <strong>SEX</strong> in the data, 0 = female, 1 = male) were asked a series of questions about how they felt their business was doing.</p>
<p>Their responses were used to construct an index of economic stress (<strong>ESTRESS</strong> in the data file, with high scores reflecting greater economic stress).</p>
<p>They were also asked the extent to which they had various feelings related to their business, such as “discouraged,” “hopeless,” “worthless,” and the like, an aggregation of which was used to quantify business-related depressed affect (<strong>AFFECT</strong> in the data, with higher scores reflecting more depressed affect).</p>
<p>They were also asked a set of questions to quantify their intentions to withdraw from entrepreneurship in the next year (<strong>WITHDRAW</strong> in the data, with higher scores indicative of greater withdrawal intentions).</p>
<p>There is also a measure of “entrepreneurial self-efficacy” which indexes a person’s confidence in his or her ability to successfully engage in various entrepreneurship-related tasks such as setting and meeting goals, creating new products, managing risk, and making decisions (<strong>ESE</strong> in the data file).</p>
<p>The dataset also includes the length of time in the business, in years (<strong>TENURE</strong> in the data), and the age of these entrepreneurs (<strong>AGE</strong>).</p>
</section>
<section id="excercise" class="level4">
<h4 class="anchored" data-anchor-id="excercise">Excercise</h4>
<p>Explore the variables (five number summary, standard deviation) and the dataset (sample size).</p>
<p>Fit a linear regression model to predict/explain <strong>withdraw</strong> intention based on the following independent variables: <strong>affect, sex, estress, age, tenure, ese</strong>.</p>
<p>Interpret the model.</p>
<p>Check out the diagnostic plots (do you see any evident pattern in the points? Are the dots grouped along a diagonal line in the normal Q-Q plot?. Also calculate the Variance Inflation Factor (VIF) using the function <em>vif</em> in the <em>car</em> package.</p>
<p>Test your understanding of the concepts and your interpretation of the linear model and assumptions by answering the questions in the quiz available on Moodle (by Tuesday). The quiz is just for your self-evaluation (i.e., <em>it is not graded</em>).</p>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">Copyright 2023, Nicola Righetti</div>   
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://www.nicolarighetti.net">
      <i class="bi bi-wordpress" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/nicolarighetti">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://mas.to/@nicolarighetti">
      <i class="bi bi-mastodon" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/nicolarighetti79/">
      <i class="bi bi-linkedin" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>



</body></html>